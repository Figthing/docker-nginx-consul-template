user  nginx;
worker_processes  auto;
worker_rlimit_nofile 100000;

error_log  /var/log/nginx/error.log warn;

pid        /var/run/nginx.pid;

events {
    use epoll;
    worker_connections  1024;
    multi_accept on;
}

http {

	include /etc/nginx/http.conf;

	#+--------------- constul template start ---------------+#
	
	
		
			
				
				
					 
						
						
						
						
						
						
						
							
							
							
							
								# save ip list
								
									
								# domain => dir => ip list
								
								
							
							
						
						

					
						
						
						
						
						
						
						
							
							
							
							
								# save ip list
								
									
								# domain => dir => ip list
								
								
							
							
						
						

					
						
						
						
						
						
						
						
							
							
							 
						
						

					
						
						
						
						
						
						
						
							
							
							 
						
						

					
						
						
						
						
						
						
						
							
							
							 
						
						

					
						
						
						
						
						
						
						
							
							
							 
						
						

					
					
					
					
				
			
		
	
		
			
				
				
					 
						
						
						
						
						
						
						
							
							
							
							
								# save ip list
								
									
								# domain => dir => ip list
								
								
							
							
						
						

					
						
						
						
						
						
						
						
							
							
							 
						
						

					
						
						
						
						
						
						
						
							
							
							 
						
						

					
					
					
					
				
			
		
	
		
	
		
	
		
			
		
	
		
			
		
	
		
	
		
	
		
			
		
	
		
	
		
	
		
	
		
			
				
				
					 
						
						
						
						
						
						
							
							
							
							
							
								# save ip list
								
									
								# domain => dir => ip list
								
								
							
							
						

					
						
						
						
						
						
						
							
							
							
							 
						

					
						
						
						
						
						
						
							
							
							
							 
						

					
					
					
					
				
			
		
	
		
			
				
				
					 
						
						
						
						
						
						
							
							
							
							
							
								# save ip list
								
									
								# domain => dir => ip list
								
								
							
							
						

					
						
						
						
						
						
						
							
							
							
							 
						

					
						
						
						
						
						
						
							
							
							
							 
						

					
					
					
					
				
			
		
	
	
	
	
	
		
			# api.cqappwb.com/backend
			upstream YXBpLmNxYXBwd2IuY29tL2JhY2tlbmQ= {
				
					server 172.19.0.6:8080 max_fails=0 fail_timeout=10s;
				
					server 172.19.0.2:8080 max_fails=0 fail_timeout=10s;
				
				keepalive 20000;
			}
		
			# api.cqappwb.com/websocket
			upstream YXBpLmNxYXBwd2IuY29tL3dlYnNvY2tldA== {
				
					server 172.19.0.14:8080 max_fails=0 fail_timeout=10s;
				
				keepalive 20000;
			}
		
		
		server {
            server_name api.cqappwb.com;
			listen 80;
			
			
				location / backend  {
				
					# api.cqappwb.com/backend
					proxy_pass http://YXBpLmNxYXBwd2IuY29tL2JhY2tlbmQ=;
					proxy_redirect             off;
					proxy_set_header           Host $host;
					proxy_set_header           X-Real-IP $remote_addr;
					proxy_set_header           X-Forwarded-For $proxy_add_x_forwarded_for;
					proxy_connect_timeout      300;
					proxy_send_timeout         300;
					proxy_read_timeout         300;
					proxy_buffer_size          4k;
					proxy_buffers              4 32k;
					proxy_busy_buffers_size    64k;
					proxy_temp_file_write_size 64k;
					ssi off;
					autoindex off;
				}
			
				location / websocket  {
				
					# api.cqappwb.com/websocket
					proxy_pass http://YXBpLmNxYXBwd2IuY29tL3dlYnNvY2tldA==;
					proxy_redirect             off;
					proxy_set_header           Host $host;
					proxy_set_header           X-Real-IP $remote_addr;
					proxy_set_header           X-Forwarded-For $proxy_add_x_forwarded_for;
					proxy_connect_timeout      300;
					proxy_send_timeout         300;
					proxy_read_timeout         300;
					proxy_buffer_size          4k;
					proxy_buffers              4 32k;
					proxy_busy_buffers_size    64k;
					proxy_temp_file_write_size 64k;
					ssi off;
					autoindex off;
				}
			
        }
	
	
		
			# www.cqappwb.com/www
			upstream d3d3LmNxYXBwd2IuY29tL3d3dw== {
				
					server 172.19.0.13:80 max_fails=0 fail_timeout=10s;
				
				keepalive 20000;
			}
		
		
		server {
            server_name www.cqappwb.com;
			listen 80;
			
			
				location / {
				
					# www.cqappwb.com/www
					proxy_pass http://d3d3LmNxYXBwd2IuY29tL3d3dw==;
					proxy_redirect             off;
					proxy_set_header           Host $host;
					proxy_set_header           X-Real-IP $remote_addr;
					proxy_set_header           X-Forwarded-For $proxy_add_x_forwarded_for;
					proxy_connect_timeout      300;
					proxy_send_timeout         300;
					proxy_read_timeout         300;
					proxy_buffer_size          4k;
					proxy_buffers              4 32k;
					proxy_busy_buffers_size    64k;
					proxy_temp_file_write_size 64k;
					ssi off;
					autoindex off;
				}
			
        }
	


	#+--------------- constul template end ---------------+#

	include /etc/nginx/conf.d/*.conf;
}


